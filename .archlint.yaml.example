# yaml-language-server: $schema=https://raw.githubusercontent.com/archlinter/archlint/main/resources/archlint.schema.json
# Archlint Configuration Example

# Files and directories to ignore globally
ignore:
  - "**/node_modules/**"
  - "**/dist/**"
  - "**/*.test.ts"
  - "**/*.spec.ts"

# Path aliases (similar to tsconfig.json)
# By default, archlint automatically loads aliases from tsconfig.json
#   tsconfig: true   - search for tsconfig.json (default)
#   tsconfig: false  - disable tsconfig synchronization
#   tsconfig: null   - disable tsconfig synchronization
#   tsconfig: "./path/to/tsconfig.json" - use specific file
tsconfig: true

# Manual aliases (these take precedence over tsconfig.json)
aliases:
  "@/*": "src/*"

# Presets to extend
extends:
  - nestjs

# Entry points for dead code analysis
entry_points:
  - "src/main.ts"

# Maximum file size in bytes to analyze (default: 1048576 = 1MB)
max_file_size: 1048576

# Rule-specific configuration
rules:
  # Short form: level or "off"
  cycles: high
  dead_code: medium

  vendor_coupling:
    severity: medium
    ignore_packages: ["lodash", "rxjs"]

  hub_dependency:
    severity: high
    ignore_packages: ["lodash", "rxjs"]

  # Full form: with additional parameters
  god_module:
    severity: high
    fan_in: 15
    fan_out: 15
    churn: 20
    exclude: ["**/legacy/**"]

  layer_violation:
    severity: high
    layers:
      - name: domain
        path: "**/domain/**"
        allowed_imports: []
      - name: application
        path: "**/application/**"
        allowed_imports: ["domain"]

# Path-specific overrides
overrides:
  - files: ["**/tests/**", "**/mocks/**"]
    rules:
      cyclomatic_complexity: off
      cognitive_complexity: off
      god_module: off

# Scoring and grading configuration
scoring:
  minimum: medium
  weights:
    critical: 100
    high: 50
    medium: 20
    low: 5

auto_detect_framework: true

# Git settings
git:
  enabled: true
  history_period: "1y"

# Architectural diff configuration
diff:
  # Percentage threshold for metric worsening to be considered a regression (default: 20)
  metric_threshold_percent: 20
  # Maximum line shift to consider smells as the same during fuzzy matching (default: 50)
  line_tolerance: 50
