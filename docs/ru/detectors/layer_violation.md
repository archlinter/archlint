# Нарушение слоев

**ID:** `layer_violation` | **Степень критичности:** Высокая (по умолчанию)

Нарушение слоев случается, когда ваша «чистая архитектура» начинает протекать. Это когда высокоуровневая бизнес-логика (Domain) внезапно начинает интересоваться таблицами в базе данных или эндпоинтами API (Infrastructure).

## Почему это «запах»

- **Дырявые абстракции**: Бизнес-логике должно быть абсолютно всё равно, используете вы Postgres или храните данные в JSON-файле. Когда слои текут, вы теряете эту свободу.
- **Хрупкие тесты**: Вам не должно требоваться поднимать мок базы данных только для того, чтобы проверить простое бизнес-правило.
- **Сложность изменений**: Хотите поменять библиотеку логирования? Удачи, ведь вы импортировали её напрямую в ядро домена, и теперь нужно перелопатить весь проект.

## Конфигурация

```yaml
rules:
  layer_violation:
    severity: high
    layers:
      - name: domain
        path: '**/domain/**'
        allowed_imports: []
      - name: application
        path: '**/application/**'
        allowed_imports: ['domain']
```

## ESLint правило

Этот детектор доступен как правило ESLint для получения обратной связи в реальном времени.

```javascript
// eslint.config.js
export default [
  {
    rules: {
      '@archlinter/no-layer-violations': 'error',
    },
  },
];
```

Смотрите [Интеграция с ESLint](/ru/integrations/eslint) для инструкций по настройке.

## Как исправить

1. **Инверсия зависимостей**: Определите интерфейс в более высоком слое (Domain) и реализуйте его в более низком слое (Infrastructure).
2. **Рефакторинг**: Перенесите ошибочно размещенный код в соответствующий слой.
