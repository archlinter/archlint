# Когнитивная сложность

**ID:** `cognitive_complexity` | **Степень критичности:** Средняя (по умолчанию)

Когнитивная сложность — это не просто количество веток в коде, а то, сколько усилий нужно мозгу человека, чтобы этот код реально понять. Это разница между «технически правильно» и «читаемо».

## Почему это «запах»

- **Переполнение ментального стека**: Люди плохо умеют держать в голове пять уровней вложенности и сложную булеву алгебру одновременно. Когда нагрузка зашкаливает, мы начинаем ошибаться.
- **Невидимые баги**: Ошибки обожают прятаться в тени вложенных `if` и тернарных операторов.
- **Трения при ревью**: Если сеньору требуется 20 минут, чтобы понять 30-строчную функцию в PR, значит, она слишком сложная.

## Как она рассчитывается

Когнитивная сложность рассчитывается на основе:

1.  **Структурные приращения**: `if`, `else`, `switch`, `for`, `while`, `do-while`, `catch`, тернарные операторы и логические последовательности.
2.  **Штраф за вложенность**: Приращения для структур управления увеличиваются в зависимости от уровня их вложенности.
3.  **Особые случаи**: `switch` считается только один раз для всего блока, независимо от количества `case`.

## Как исправить

1.  **Упростите логику**: Используйте guard clauses (ранние возвраты), чтобы уменьшить вложенность.
2.  **Выделение метода**: Перенесите вложенные блоки или сложные условия в небольшие, сфокусированные функции.
3.  **Упростите выражения**: Разбейте сложные логические условия на промежуточные переменные или функции.
4.  **Замените вложенные If**: Рассмотрите возможность использования таблицы поиска или паттерна «Стратегия».

## Конфигурация

```yaml
rules:
  cognitive_complexity:
    severity: medium
    max_complexity: 15
```

## Правило ESLint

Этот детектор доступен, как правило, ESLint для получения обратной связи в реальном времени прямо в редакторе.

```javascript
// eslint.config.js
export default [
  {
    rules: {
      '@archlinter/no-high-cognitive-complexity': 'warn',
    },
  },
];
```
