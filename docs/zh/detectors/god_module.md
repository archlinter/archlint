# 上帝模块

**ID:** `god_module` | **严重程度:** 高 (默认)

“上帝模块”就是项目中那个大家都不敢碰的文件，因为它几乎接管了所有工作。它通常始于一个简单的辅助函数，最后却演变成了一个同时处理身份验证、数据库查询和 UI 状态的“巨无霸”。

## 为什么这是一种坏味道

- **单一职责的噩梦**：当一个模块什么都做时，任何改动（无论多么微小）都像是在给你的系统架构玩“叠叠乐”（Jenga）。
- **冲突磁铁**：作为“宇宙中心”，团队中的每个开发人员都在不断修改它，这保证了在合并代码时会有无休止的冲突。
- **脆弱性**：模块某一部分的改动可能会意外地破坏另一部分，因为所有东西都隐式地耦合在一起。
- **测试头痛**：你本不应该为了测试一个简单的字符串格式化逻辑，而去模拟（mock）整个数据库和邮件服务。

## 检测标准

`archlint` 根据以下指标识别上帝模块：

- **Fan-in（扇入）**：依赖于它的其他模块的数量。
- **Fan-out（扇出）**：它所依赖的模块的数量。
- **Churn（变更频率）**：在 git 中的更改频率。
- **Lines of Code（代码行数）**：文件的总大小。

## 如何修复

1. **识别职责**：列出模块执行的所有不同任务。
2. **提取模块**：将文件拆分为更小、更集中的模块。
3. **外观模式（Facade Pattern）**：如果该模块充当协调器，请仅保留协调逻辑，并将具体工作委托给子模块。

## 配置

```yaml
rules:
  god_module:
    severity: high
    fan_in: 15
    fan_out: 15
    churn: 20
```

## ESLint 规则

此检测器可作为 ESLint 规则使用，以便在编辑器中获得实时反馈。

```javascript
// eslint.config.js
export default [
  {
    rules: {
      '@archlinter/no-god-modules': 'warn',
    },
  },
];
```

详见 [ESLint 集成](/zh/integrations/eslint) 了解设置说明。
