# ゴッドモジュール

**ID:** `god_module` | **重要度:** High (default)

「ゴッドモジュール」とは、プロジェクト内の誰もが触れるのを恐れるような、何でも屋になってしまったファイルのことです。最初はシンプルなユーティリティとして始まり、いつの間にか認証、データベースクエリ、UIの状態管理を同時にこなす「怪物」へと成長してしまいます。

## なぜこれが「不吉な臭い」なのか

- **単一責任の原則の崩壊**: 一つのモジュールがすべてを担うと、どんなに小さな変更であっても、アーキテクチャ全体でジェンガをしているような危うさを感じることになります。
- **マージ競合の温床**: 「宇宙の中心」のようなファイルなので、チームの全員が常に変更を加えています。その結果、マージのたびに果てしない競合に悩まされることになります。
- **脆弱性**: モジュールの端っこを修正したつもりが、全く別の場所を壊してしまうことがあります。中身が複雑に絡み合っているからです。
- **テストが地獄**: 単なる文字列のフォーマッタをテストしたいだけなのに、データベースやメールサービスのモックを用意しなければならないような状況は避けるべきです。

## 検出基準

`archlint` は以下の基準に基づいてゴッドモジュールを特定します：

- **ファンイン（Fan-in）**: そのモジュールに依存している他のモジュールの数。
- **ファンアウト（Fan-out）**: そのモジュールが依存している他のモジュールの数。
- **チャーン（Churn）**: git における変更の頻度。
- **コード行数（Lines of Code）**: ファイルの総サイズ。

## 修正方法

1. **責任の特定**: モジュールが実行しているすべての異なるタスクをリストアップします。
2. **モジュールの抽出**: ファイルをより小さく、焦点の絞られたモジュールに分割します。
3. **ファサードパターン（Facade Pattern）**: モジュールがコーディネーターとして機能している場合は、調整ロジックのみを保持し、実際の作業はサブモジュールに委譲します。

## 設定

```yaml
rules:
  god_module:
    severity: high
    fan_in: 15
    fan_out: 15
    churn: 20
```

## ESLint ルール

このディテクターは、エディター内でリアルタイムのフィードバックを提供する ESLint ルールとして利用可能です。

```javascript
// eslint.config.js
export default [
  {
    rules: {
      '@archlinter/no-god-modules': 'warn',
    },
  },
];
```

セットアップ手順については [ESLint Integration](/ja/integrations/eslint) を参照してください。
